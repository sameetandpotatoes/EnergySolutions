- content_for :head do
  %title Energy Solutions | Results
%p.state{style: "display: none;"}= @state
%div.results
  %h1.header-results
    Renewable Energy Sources Available in #{@city.titlecase}, #{@state}
  .results-energy
    - if (@wind)
      = image_tag("check.png", :width=>"25", :height=> "40", :class=>"image")
      %p.results-inline Wind Energy is a good fit for your location.
    - else
      = image_tag("x.png", :width=>"25", :height=> "40", :class=>"image")
      %p.results-inline Wind Energy will not work well in your location.
  .results-energy
    - if (@solar)
      = image_tag("check.png", :width=>"25", :height=> "40", :class=>"image")
      %p.results-inline Solar Energy is a good fit for your location.
    - else
      = image_tag("x.png", :width=>"25", :height=> "40", :class=>"image")
      %p.results-inline Solar Energy will not work well in your location.
  .results-energy
    - if (@geo)
      = image_tag("check.png", :width=>"25", :height=> "40", :class=>"image")
      %p.results-inline Geothermal Energy is a good fit for your location.
    - else
      = image_tag("x.png", :width=>"25", :height=> "40", :class=>"image")
      %p.results-inline Geothermal Energy will not work well in your location.
  .results-energy
    - if (@biomass)
      = image_tag("check.png", :width=>"25", :height=> "40", :class=>"image")
      %p.results-inline Biomass Energy is a good fit for your location.
    - else
      = image_tag("x.png", :width=>"25", :height=> "40", :class=>"image")
      %p.results-inline Biomass Energy will not work well in your location.
%script{src: "https://maps.googleapis.com/maps/api/js?key=AIzaSyCSLTNWsGK06_1V4Nf-O1AlOR5X0iSuxY8&sensor=false", type: "text/javascript"}
:javascript
  var map;
  function initialize() {
      var latlng = new google.maps.LatLng(57.0442, 9.9116);
      var settings = {
          zoom: 15,
          center: latlng,
          mapTypeControl: true,
          mapTypeControlOptions: {style: google.maps.MapTypeControlStyle.DROPDOWN_MENU},
          navigationControl: true,
          navigationControlOptions: {style: google.maps.NavigationControlStyle.SMALL},
          mapTypeId: google.maps.MapTypeId.ROADMAP
      };
      map = new google.maps.Map(document.getElementById("map_canvas"), settings);
  };
  google.maps.event.addDomListener(window, 'load', initialize);
#map-canvas
%h1.header-results
  Grants near #{@city.titlecase}, #{@state}
%p.source-text Information provided by dsireusa.org and afdc.energy.gov
#grants.grantsinfo
:javascript
  $(document).ready(function(){
  	var state=$('.state').text();
  	$("#grants").load("http://www.dsireusa.org/incentives/index.cfm?re=0&ee=0&spv=0&st=0&srp=1&state="+state);
  	$.ajax({
  	url: 'http://www.dsireusa.org/incentives/index.cfm?re=0&ee=0&spv=0&st=0&srp=1&state='+state,
  	type: 'GET',
  	success: function(res)
  	{
  	  var headline = $(res.responseText).find('#incentivelist').html();
  	  var div = document.getElementById('grants');
  	  div.innerHTML = headline;
  	  $("#grants ul li a").each(function(){
  	  	var _href = $(this).attr("href");
  	  	$(this).attr("href", "http://www.dsireusa.org/incentives/"+_href);
  	  	$(this).attr("target", "_blank");
  	  });
  	}
  	});
  });
#moregrants.grantsinfo
:javascript
  $(document).ready(function(){
    var state=$('.state').text();
    $("#moregrants").load("http://www.afdc.energy.gov/laws/state_summary/"+state);
    $.ajax({
    url: 'http://www.afdc.energy.gov/laws/state_summary/'+state,
    type: 'GET',
    success: function(res)
    {
      var headline = $(res.responseText).find('.summary_table').html();
      var div = document.getElementById('moregrants');
      div.innerHTML = headline;
      $(".summary_table ul li a").each(function(){
        var _href = $(this).attr("href");
        $(this).attr("href", "http://www.afdc.energy.gov/"+_href);
        $(this).attr("target", "_blank");
      });
    }
    });
  });
